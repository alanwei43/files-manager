(function(e){function t(t){for(var a,r,s=t[0],u=t[1],c=t[2],f=0,p=[];f<s.length;f++)r=s[f],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&p.push(i[r][0]),i[r]=0;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(e[a]=u[a]);l&&l(t);while(p.length)p.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,s=1;s<n.length;s++){var u=n[s];0!==i[u]&&(a=!1)}a&&(o.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},i={app:0},o=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var l=u;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},o=[];n("99af"),n("a15b"),n("d81d"),n("b64b"),n("d3b7");function r(e,t,n,a){var i={method:e,headers:{"content-type":"application/json"}};return n&&(t+="?"+Object.keys(n).map((function(e){return"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(n[e]))})).join("&")),a&&(i.body=JSON.stringify(a)),fetch(t,i).then((function(e){return e.json()}))}function s(e,t){return r("GET",e,t)}function u(e,t,n){return r("POST",e,n,t)}n("ac1f"),n("25f0"),n("1276");function c(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(e){var n=e.target.result.split("base64,")[1];t(n)},a.onerror=function(){n()},a.readAsDataURL(e)}))}function l(){return Date.now().toString(16)+Math.random().toString(16).substr(2)}var f={config:{title:void 0,copyBase:void 0}},p={data:function(){return{share:f}},mounted:function(){var e=this;s("/resources/config.json").then((function(t){e.share.config=t,document.title=e.share.config.title}))}},d=p,h=n("2877"),m=Object(h["a"])(d,i,o,!1,null,null,null),v=m.exports,g=n("8c4f"),b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"nav"}},[n("router-link",{attrs:{to:"/"}},[e._v("Home")]),e._v("| "),n("router-link",{attrs:{to:"/list-files"}},[e._v("list files")])],1)},_=[],w={name:"Home"},y=w,F=Object(h["a"])(y,b,_,!1,null,null,null),O=F.exports,j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("file-upload",{attrs:{path:e.route.path},on:{"upload-success":e.onUploadSuccess}}),n("ol",e._l(e.files.data,(function(t){return n("file-item",{key:t.path||t.name,attrs:{item:t,path:e.route.path},on:{"delete-file":e.onDeleteFile}})})),1)],1)},k=[],E=(n("c975"),n("fb6a"),n("a434"),n("b0c0"),n("5319"),n("9911"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",[e.item.isDir?n("router-link",{attrs:{to:e.item.link}},[e._v(e._s(e.item.name))]):e._e(),e.item.isFile?n("span",[e._v(e._s(e.item.name))]):e._e(),e._v(" "),e.item.isFile?n("button",{staticClass:"btn btn-warning btn-xs",on:{click:function(t){return e.deleteFile(e.item)}}},[e._v("删除")]):e._e(),e._v(" "),e.downloadLink?n("a",{staticClass:"btn btn-default btn-xs",attrs:{target:"blank",href:e.downloadLink}},[e._v("下载")]):e._e(),e._v(" "),e.item.isFile?n("span",{staticClass:"btn btn-default btn-xs"},[e._v("打开")]):e._e()],1)}),D=[],x={props:{item:{required:!0},path:{required:!0}},data:function(){return{}},mounted:function(){},methods:{deleteFile:function(e){var t=this;r("DELETE","/api/files",null,{name:this.item.name,path:this.path}).then((function(n){n.success&&t.$emit("delete-file",e)}))}},computed:{downloadLink:function(){if(this.item.isFile)return"/api/file?name=".concat(encodeURIComponent(this.item.name),"&path=").concat(encodeURIComponent(this.path))}}},S=x,C=Object(h["a"])(S,E,D,!1,null,null,null),R=C.exports,L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h5",[e._v("上传文件: ")]),n("input",{attrs:{type:"file",multiple:""},on:{change:e.selectFile}}),e._l(e.status.process,(function(t){return n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"process.show"}],key:t.key},[n("b",[e._v(e._s(t.name))]),"loading"===t.load?n("span",[e._v("正在上传")]):e._e(),"fail"===t.load?n("span",[e._v("上传失败 "+e._s(t.error))]):e._e(),"success"===t.load?n("span",[e._v("上传成功")]):e._e()])})),n("hr")],2)},P=[],$=(n("4160"),n("159b"),n("bf19"),{props:{path:{required:!0}},data:function(){return{config:{randomName:!1},status:{process:[],onDraging:!1}}},mounted:function(){this.initDrag()},methods:{selectFile:function(e){var t=this,n=e.target.files||[];n.forEach((function(e){return t.uploadFile(e)}))},uploadFile:function(e){var t=this,n=e.name;if(this.config.randomName){var a=e.name.split(".").slice(-1);n=l()+"."+a}var i={key:l(),name:e.name,path:this.path,load:"loading",error:void 0,show:!0};this.status.process.push(i),c(e).then((function(e){return u("/api/files",{name:n,path:t.path,data:e})})).then((function(a){if(a.success)return i.load="success",t.$emit("upload-success",{ctime:(new Date).toJSON(),isDir:!1,isFile:!0,mtime:(new Date).toJSON(),name:n,path:void 0,size:e.size}),"success";throw new Error("upload_fail")})).catch((function(e){return i.load="fail",i.error=e.message||e,"fail"})).then((function(e){setTimeout((function(){return i.show=!1}),"success"===e?3e3:5e3)}))},initDrag:function(){var e=this,t=document.documentElement;["dragenter","dragover","dragleave","drop"].forEach((function(e){t.addEventListener(e,(function(e){e.preventDefault(),e.stopPropagation()}),!1)})),["dragenter","dragover"].forEach((function(n){t.addEventListener(n,(function(){return e.status.onDraging=!0}),!1)})),["dragleave","drop"].forEach((function(n){t.addEventListener(n,(function(){return e.status.onDraging=!1}),!1)})),t.addEventListener("drop",(function(t){var n=t.dataTransfer.files||[];n.forEach((function(t){return e.uploadFile(t)}))}),!1)}}}),U=$,M=Object(h["a"])(U,L,P,!1,null,null,null),T=M.exports,I={data:function(){return{files:{data:[]},route:{path:void 0,parent:void 0},status:{process:[],onDraging:!1}}},mounted:function(){this.loadFiles(),this.onRouteChange()},methods:{loadFiles:function(){var e=this;if(this.route.path){var t=this.route.path;s("/api/files",{path:t}).then((function(n){if(t===e.route.path&&(e.files.data=n.files.map((function(e){return{ctime:e.ctime,isDir:e.isDir,isFile:e.isFile,mtime:e.mtime,name:e.name,path:e.path,size:e.size}})).map((function(t){return t.link="".concat(location.pathname,"/").concat(t.name),t.isFile&&(t.downloadLink="/api/file?name=".concat(encodeURIComponent(t.name),"&path=").concat(encodeURIComponent(e.route.path))),t})),"string"===typeof e.route.parent)){var a=l();e.files.data.unshift({isDir:!0,isFile:!1,link:(location.pathname+a).replace(e.route.path+a,"")+e.route.parent,name:"上一级目录"})}}))}},onRouteChange:function(){this.route.path=this.$route.params.pathMatch||"/","string"===typeof this.route.path&&"/"!==this.route.path?this.route.parent=this.route.path.split("/").slice(0,-1).join("/")||"/":this.route.parent=void 0,this.loadFiles()},onDeleteFile:function(e){var t=this.files.data.indexOf(e);this.files.data.splice(t,1)},onUploadSuccess:function(e){this.files.data.push(e)}},components:{"file-item":R,"file-upload":T},watch:{$route:"onRouteChange"}},N=I,J=Object(h["a"])(N,j,k,!1,null,null,null),z=J.exports;a["a"].use(g["a"]);var q=[{path:"/",name:"Home",component:O},{path:"/files-manager",name:"FilesManagerRoot",component:z},{path:"/files-manager/*",name:"FilesManager",component:z},{path:"*",component:O}],H=new g["a"]({mode:"history",base:"/",routes:q}),A=H;a["a"].config.productionTip=!1,new a["a"]({router:A,render:function(e){return e(v)}}).$mount("#app")}});
//# sourceMappingURL=app.975d6ac3.js.map